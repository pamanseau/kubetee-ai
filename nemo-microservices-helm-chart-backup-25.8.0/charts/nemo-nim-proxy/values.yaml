# Default values for nim-proxy.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

# -- The number of replicas for the NeMo NIM Proxy service.
replicaCount: 1

# -- Specifies a namespace to restrict the NIM Proxy microservice to watch NIMs in. Leave it empty to watch all namespaces.
nimNamespace: ""

# -- Additional environment variables to pass to containers. The format is `NAME: value` or `NAME: valueFrom: {object}`.
env:
  {}

image:
  # -- The repository of the NIM Proxy container image.
  repository: nvcr.io/nvidia/nemo-microservices/nim-proxy
  # -- The container image pull policy for the NIM Proxy container.
  pullPolicy: IfNotPresent
  # -- The container image tag. If not set, the default value is `appVersion` from the `Chart.yaml` file.
  tag: ""

# -- (list) Image pull secrets for accessing the NGC container registry.
imagePullSecrets: []
# -- String to partially override name on resulting Kubernetes objects when the NIM Proxy microservice is deployed.
nameOverride: ""
# -- String to fully override the name on resulting Kubernetes objects when the NIM Proxy microservice is deployed.
fullnameOverride: ""

serviceAccount:
  # -- Whether to create a service account for the NIM Proxy microservice.
  create: true
  # -- Whether to automatically mount a ServiceAccount's API credentials.
  automount: true
  # -- Annotations to add to the service account.
  annotations: {}
  # -- The name of the service account to use. If not set and create is `true`, a name is generated using the full name template.
  name: ""
# -- Pod annotations.
podAnnotations: {}
# -- Pod labels.
podLabels: {}
# -- Pod security context. Use the default settings, unless you understand what changes in the pod security context settings you want to apply.
podSecurityContext: {}
  # fsGroup: 2000

# -- Security context. Use the default settings, unless you understand what changes in the security context settings you want to apply.
securityContext:
  # capabilities:
  #   drop:
  #   - ALL
  # -- Whether to run with a read-only root filesystem.
  readOnlyRootFilesystem: true
  # runAsNonRoot: true
  # runAsUser: 1000

service:
  main:
    # -- The type of the main service.
    type: ClusterIP
    # -- The port of the main service.
    port: 8000
  metricsPort:
    # -- The type of the metrics service.
    type: ClusterIP
    # -- The port of the metrics service.
    port: 8001

ingress:
  # -- Whether to enable the ingress controller resource.
  enabled: false
  # -- The ingress class to use.
  className: ""
  # -- Ingress annotations.
  annotations: {}
    # kubernetes.io/ingress.class: nginx
    # kubernetes.io/tls-acme: "true"
  # -- (list) A list of maps, each containing the keys `host` and `paths` for the ingress resource. You must specify a list for configuring ingress for the microservice.
  # @default -- []
  hosts: {}
  #   - host: chart-example.local
  #     paths:
  #       - path: /
  #         pathType: ImplementationSpecific
  # -- Ingress TLS configuration.
  tls: []
  #  - secretName: chart-example-tls
  #    hosts:
  #      - chart-example.local

# -- Configures Kubernetes resource requests and limits for the NIM Proxy microservice. Use the default settings and leave it with the empty object as is, unless you understand what changes you want to make.
resources: {}
  # We usually recommend not to specify default resources and to leave this as a conscious
  # choice for the user. This also increases chances charts run on environments with little
  # resources, such as Minikube. If you do want to specify resources, uncomment the following
  # lines, adjust them as necessary, and remove the curly braces after 'resources:'.
  # limits:
  #   cpu: 100m
  #   memory: 128Mi
  # requests:
  #   cpu: 100m
  #   memory: 128Mi

livenessProbe:
  httpGet:
    # -- The HTTP path for the Kubernetes liveness probe. Do not change this.
    path: /health
    # -- The port name for the Kubernetes liveness probe. Do not change this.
    port: http

readinessProbe:
  httpGet:
    # -- The HTTP path for the Kubernetes readiness probe. Do not change this.
    path: /health
    # -- The port name for the Kubernetes readiness probe. Do not change this.
    port: http

autoscaling:
  # -- Whether to enable horizontal pod autoscaling for the NIM Proxy microservice.
  enabled: false
  # -- The minimum number of replicas for the NIM Proxy microservice.
  minReplicas: 1
  # -- The maximum number of replicas for the NIM Proxy microservice.
  maxReplicas: 100
  # -- The target CPU utilization percentage for the NIM Proxy microservice.
  targetCPUUtilizationPercentage: 80
  # targetMemoryUtilizationPercentage: 80

# -- Additional volumes for the NIM Proxy microservice. Use the default settings and leave it with the empty list as is, unless you understand what changes you want to make.
volumes: []
# - name: foo
#   secret:
#     secretName: mysecret
#     optional: false

# -- Additional volume mounts for the NIM Proxy microservice. Use the default settings and leave it with the empty list as is, unless you understand what changes you want to make.
volumeMounts: []
# - name: foo
#   mountPath: "/etc/foo"
#   readOnly: true

# -- Specifies labels to ensure that the microservice is deployed only on certain nodes. To learn more, refer to [Node Selector](https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector) in the Kubernetes documentation.
nodeSelector: {}

# -- Specifies tolerations for pod assignment. To learn more, refer to [Taint and Toleration](https://kubernetes.io/docs/concepts/scheduling-eviction/taint-and-toleration/) in the Kubernetes documentation.
tolerations: []

# -- Specifies affinity settings for the deployment. To learn more, refer to [Affinity and Anti-Affinity](https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#affinity-and-anti-affinity) in the Kubernetes documentation.
affinity: {}

# -- Prometheus metrics collection configuration for monitoring the NIM Proxy microservice. To enable this, you should install the Prometheus operator before deploying the NIM Proxy microservice.
monitoring:
  # -- Whether to enable monitoring for the NIM Proxy microservice.
  enabled: true
  # -- The scrape interval for monitoring.
  interval: 30s
  # -- The metrics path for monitoring.
  path: /v1/metrics
  # -- The scheme for monitoring.
  scheme: http
